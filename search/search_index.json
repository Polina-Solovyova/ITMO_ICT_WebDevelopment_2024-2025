{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"WEB-\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 2 \u041b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 2. \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430 \u043d\u0430 django. \u0421\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435 \u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u041c\u043e\u0434\u0435\u043b\u0438 \u0424\u043e\u0440\u043c\u044b \u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u041c\u0430\u0440\u0448\u0440\u0443\u0442\u044b","title":"WEB-\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 2"},{"location":"#web-2","text":"\u041b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 2. \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430 \u043d\u0430 django.","title":"WEB-\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 2"},{"location":"#_1","text":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u041c\u043e\u0434\u0435\u043b\u0438 \u0424\u043e\u0440\u043c\u044b \u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u041c\u0430\u0440\u0448\u0440\u0443\u0442\u044b","title":"\u0421\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435"},{"location":"admin/","text":"\u0410\u0434\u043c\u0438\u043d \u043f\u0430\u043d\u0435\u043b\u044c CustomUser \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0438 \u043f\u0440\u0430\u0432\u0430\u043c \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430. \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u0435 \u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0439 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438. @admin.register(CustomUser) class CustomUserAdmin(admin.ModelAdmin): list_display = ('username', 'email', 'is_staff', 'is_active') list_filter = ('is_staff', 'is_active') search_fields = ('username', 'email') TravelAgency \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430. \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430. @admin.register(TravelAgency) class TravelAgencyAdmin(admin.ModelAdmin): list_display = ('name', 'contact_info') search_fields = ('name',) ordering = ('name',) Tour \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0437\u0432\u0435\u0437\u0434, \u0441\u0442\u0440\u0430\u043d\u0435 \u0438 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0443. \u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f, \u0433\u043e\u0440\u043e\u0434\u0443 \u0438 \u0441\u0442\u0440\u0430\u043d\u0435 \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 \u043d\u0430\u0447\u0430\u043b\u0430. @admin.register(Tour) class TourAdmin(admin.ModelAdmin): list_display = ('hotel', 'stars', 'agency', 'country', 'city', 'start_date', 'end_date') list_filter = ('stars', 'country', 'agency') search_fields = ('hotel', 'country', 'city') ordering = ('start_date',) Tariff \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u0442\u0443\u0440\u0443. \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0442\u0430\u0440\u0438\u0444\u0430. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0442\u0430\u0440\u0438\u0444\u043e\u0432 \u043f\u043e \u0446\u0435\u043d\u0435. @admin.register(Tariff) class TariffAdmin(admin.ModelAdmin): list_display = ('name', 'price', 'tour') list_filter = ('tour',) search_fields = ('name',) ordering = ('price',) MealOption \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u043f\u043e \u0442\u0443\u0440\u0443. \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0430 \u043f\u0438\u0442\u0430\u043d\u0438\u044f. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e \u0446\u0435\u043d\u0435. @admin.register(MealOption) class MealOptionAdmin(admin.ModelAdmin): list_display = ('name', 'price', 'tour') list_filter = ('tour',) search_fields = ('name',) ordering = ('price',) Booking \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f, \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u0442\u0443\u0440\u0443. \u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f (\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u043a \u0441\u0442\u0430\u0440\u044b\u043c). @admin.register(Booking) class BookingAdmin(admin.ModelAdmin): list_display = ('user', 'tour', 'num_people', 'tariff', 'meal_option', 'is_confirmed', 'total_price', 'created') list_filter = ('is_confirmed', 'created', 'tour') search_fields = ('user__username', 'tour__hotel') ordering = ('-created',) Review \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043f\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0443, \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u0442\u0443\u0440\u0443. \u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f \u0438 \u0442\u0435\u043a\u0441\u0442\u0443 \u043e\u0442\u0437\u044b\u0432\u0430. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 (\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u043a \u0441\u0442\u0430\u0440\u044b\u043c). @admin.register(Review) class ReviewAdmin(admin.ModelAdmin): list_display = ('user', 'tour', 'rating', 'date', 'text') list_filter = ('rating', 'date', 'tour') search_fields = ('user__username', 'tour__hotel', 'text') ordering = ('-date',)","title":"\u0410\u0434\u043c\u0438\u043d \u043f\u0430\u043d\u0435\u043b\u044c"},{"location":"admin/#_1","text":"","title":"\u0410\u0434\u043c\u0438\u043d \u043f\u0430\u043d\u0435\u043b\u044c"},{"location":"admin/#customuser","text":"\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0438 \u043f\u0440\u0430\u0432\u0430\u043c \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430. \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u0435 \u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0439 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438. @admin.register(CustomUser) class CustomUserAdmin(admin.ModelAdmin): list_display = ('username', 'email', 'is_staff', 'is_active') list_filter = ('is_staff', 'is_active') search_fields = ('username', 'email')","title":"CustomUser"},{"location":"admin/#travelagency","text":"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430. \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430. @admin.register(TravelAgency) class TravelAgencyAdmin(admin.ModelAdmin): list_display = ('name', 'contact_info') search_fields = ('name',) ordering = ('name',)","title":"TravelAgency"},{"location":"admin/#tour","text":"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0437\u0432\u0435\u0437\u0434, \u0441\u0442\u0440\u0430\u043d\u0435 \u0438 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0443. \u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f, \u0433\u043e\u0440\u043e\u0434\u0443 \u0438 \u0441\u0442\u0440\u0430\u043d\u0435 \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 \u043d\u0430\u0447\u0430\u043b\u0430. @admin.register(Tour) class TourAdmin(admin.ModelAdmin): list_display = ('hotel', 'stars', 'agency', 'country', 'city', 'start_date', 'end_date') list_filter = ('stars', 'country', 'agency') search_fields = ('hotel', 'country', 'city') ordering = ('start_date',)","title":"Tour"},{"location":"admin/#tariff","text":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u0442\u0443\u0440\u0443. \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0442\u0430\u0440\u0438\u0444\u0430. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0442\u0430\u0440\u0438\u0444\u043e\u0432 \u043f\u043e \u0446\u0435\u043d\u0435. @admin.register(Tariff) class TariffAdmin(admin.ModelAdmin): list_display = ('name', 'price', 'tour') list_filter = ('tour',) search_fields = ('name',) ordering = ('price',)","title":"Tariff"},{"location":"admin/#mealoption","text":"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u043f\u043e \u0442\u0443\u0440\u0443. \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0430 \u043f\u0438\u0442\u0430\u043d\u0438\u044f. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e \u0446\u0435\u043d\u0435. @admin.register(MealOption) class MealOptionAdmin(admin.ModelAdmin): list_display = ('name', 'price', 'tour') list_filter = ('tour',) search_fields = ('name',) ordering = ('price',)","title":"MealOption"},{"location":"admin/#booking","text":"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f, \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u0442\u0443\u0440\u0443. \u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f (\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u043a \u0441\u0442\u0430\u0440\u044b\u043c). @admin.register(Booking) class BookingAdmin(admin.ModelAdmin): list_display = ('user', 'tour', 'num_people', 'tariff', 'meal_option', 'is_confirmed', 'total_price', 'created') list_filter = ('is_confirmed', 'created', 'tour') search_fields = ('user__username', 'tour__hotel') ordering = ('-created',)","title":"Booking"},{"location":"admin/#review","text":"\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043f\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0443, \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u0442\u0443\u0440\u0443. \u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f \u0438 \u0442\u0435\u043a\u0441\u0442\u0443 \u043e\u0442\u0437\u044b\u0432\u0430. \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 (\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u043a \u0441\u0442\u0430\u0440\u044b\u043c). @admin.register(Review) class ReviewAdmin(admin.ModelAdmin): list_display = ('user', 'tour', 'rating', 'date', 'text') list_filter = ('rating', 'date', 'tour') search_fields = ('user__username', 'tour__hotel', 'text') ordering = ('-date',)","title":"Review"},{"location":"forms/","text":"\u0424\u043e\u0440\u043c\u044b TourForm class TourForm(forms.ModelForm): class Meta: model = Tour fields = [ 'hotel', 'stars', 'agency', 'country', 'city', 'description', 'start_date', 'end_date', 'payment_conditions', ] widgets = { 'start_date': forms.DateInput(attrs={'type': 'date'}), # \u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f start_date 'end_date': forms.DateInput(attrs={'type': 'date'}), # \u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f end_date } def clean_start_date(self): start_date = self.cleaned_data.get('start_date') today = date.today() if start_date < today: raise forms.ValidationError(\"Start date must be today or later.\") return start_date def clean_end_date(self): end_date = self.cleaned_data.get('end_date') if end_date < self.cleaned_data.get('start_date'): raise forms.ValidationError(\"End date cannot be before start date.\") return end_date \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0432\u0432\u043e\u0434\u0430 \u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0438 Tour. \u0412\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 Tour. \u041f\u043e\u043b\u044f start_date \u0438 end_date \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 HTML-\u0432\u0438\u0434\u0436\u0435\u0442 \u0441 \u0442\u0438\u043f\u043e\u043c date, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u0430 \u0434\u0430\u0442. clean_start_date: \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u0447\u0442\u043e \u0434\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 (start_date) \u043d\u0435 \u0440\u0430\u043d\u044c\u0448\u0435 \u0441\u0435\u0433\u043e\u0434\u043d\u044f\u0448\u043d\u0435\u0433\u043e \u0434\u043d\u044f. \u0415\u0441\u043b\u0438 \u0434\u0430\u0442\u0430 \u043d\u0435 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443, \u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u0430. clean_end_date: \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u0447\u0442\u043e \u0434\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f (end_date) \u043d\u0435 \u043f\u0440\u0435\u0434\u0448\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0434\u0430\u0442\u0435 \u043d\u0430\u0447\u0430\u043b\u0430. \u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u043e, \u0442\u0430\u043a\u0436\u0435 \u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u0430. \u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 Tour, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0432\u044b\u0431\u043e\u0440 \u0434\u0430\u0442 \u0447\u0435\u0440\u0435\u0437 \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0438 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043d\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c. TariffForm \u0438 MealOptionForm class TariffForm(forms.ModelForm): class Meta: model = Tariff fields = ['name', 'price'] class MealOptionForm(forms.ModelForm): class Meta: model = MealOption fields = ['name', 'price'] # Inline formsets \u0434\u043b\u044f Tariff \u0438 MealOption TariffFormSet = inlineformset_factory( Tour, Tariff, form=TariffForm, extra=1, can_delete=True ) MealOptionFormSet = inlineformset_factory( Tour, MealOption, form=MealOptionForm, extra=1, can_delete=True ) \u041a\u043b\u0430\u0441\u0441\u044b TariffForm \u0438 MealOptionForm: \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u0444\u043e\u0440\u043c\u044b \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0435\u0439 Tariff \u0438 MealOption. \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u044e\u0442, \u0447\u0442\u043e name \u0438 price \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. TariffFormSet \u0438 MealOptionFormSet: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 inlineformset_factory \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438\u043d\u043b\u0430\u0439\u043d\u043e\u0432\u044b\u0445 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0445 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b Tariff \u0438 MealOption \u043f\u0440\u044f\u043c\u043e \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0434\u043b\u044f \u0442\u0443\u0440\u0430. \u0421\u0432\u044f\u0437\u044c \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043c\u043e\u0434\u0435\u043b\u044c Tour. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438: - form: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0444\u043e\u0440\u043c\u044b (TariffForm \u0438 MealOptionForm). - extra=1: \u041f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0432 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0434\u043d\u0430 \u043f\u0443\u0441\u0442\u0430\u044f \u0444\u043e\u0440\u043c\u0430 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e. - can_delete=True: \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 \u0444\u043e\u0440\u043c\u0443. CustomAuthenticationForm class CustomAuthenticationForm(AuthenticationForm): username = forms.CharField(widget=forms.TextInput(attrs={ 'class': 'form-control', 'placeholder': 'Username' })) password = forms.CharField(widget=forms.PasswordInput(attrs={ 'class': 'form-control', 'placeholder': 'Password' })) \u041d\u0430\u0441\u043b\u0435\u0434\u0443\u0435\u0442\u0441\u044f \u043e\u0442 AuthenticationForm \u0438 \u043a\u0430\u0441\u0442\u043e\u043c\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u043f\u043e\u043b\u044f username \u0438 password, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044f \u0441\u0442\u0438\u043b\u0438 \u0438 \u043f\u043b\u0435\u0439\u0441\u0445\u043e\u043b\u0434\u0435\u0440\u044b \u0434\u043b\u044f \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u044f \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u0432\u0438\u0434\u0430 \u0432\u0432\u043e\u0434\u0430. CustomUserCreationForm class CustomUserCreationForm(UserCreationForm): class Meta: model = CustomUser fields = ['username', 'email', 'password1', 'password2'] \u041d\u0430\u0441\u043b\u0435\u0434\u0443\u0435\u0442\u0441\u044f \u043e\u0442 UserCreationForm \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043f\u043e\u043b\u044f\u043c\u0438 username, email, password1, password2. BookingForm class BookingForm(forms.ModelForm): class Meta: model = Booking fields = ['num_people', 'tariff', 'meal_option'] def __init__(self, *args, **kwargs): tour = kwargs.pop('tour', None) super().__init__(*args, **kwargs) if tour: # \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u043c \u0432\u044b\u0431\u043e\u0440 \u0442\u0430\u0440\u0438\u0444\u043e\u0432 \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043f\u0438\u0442\u0430\u043d\u0438\u044f self.fields['tariff'].queryset = tour.tariffs.all() self.fields['meal_option'].queryset = tour.meal_options.all() self.fields['tariff'].widget = forms.Select( attrs={ 'class': 'tariff-select', }, choices=[(tariff.id, f'{tariff.name} - {tariff.price} RUB') for tariff in tour.tariffs.all()] ) self.fields['meal_option'].widget = forms.Select( attrs={ 'class': 'meal-select', }, choices=[(meal.id, f'{meal.name} - {meal.price} RUB') for meal in tour.meal_options.all()] ) \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0443\u0440\u0430. \u041e\u043d\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043b\u044e\u0434\u0435\u0439 (num_people), \u0442\u0430\u0440\u0438\u0444 (tariff) \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u0438\u0442\u0430\u043d\u0438\u044f (meal_option). \u0412 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440\u0435 \u0444\u043e\u0440\u043c\u044b \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. ReviewForm class ReviewForm(forms.ModelForm): class Meta: model = Review fields = ['text', 'rating'] \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0442\u0437\u044b\u0432\u0430. \u041e\u043d\u0430 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0434\u0432\u0430 \u043f\u043e\u043b\u044f: \u0442\u0435\u043a\u0441\u0442 \u043e\u0442\u0437\u044b\u0432\u0430 \u0438 \u0440\u0435\u0439\u0442\u0438\u043d\u0433. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043e\u0442\u0437\u044b\u0432\u0430 \u043e \u0442\u0443\u0440\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u0442\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445. TourSearchForm class TourSearchForm(forms.Form): query = forms.CharField(label='Search', max_length=100, required=False) \u041f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0430 \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u0442\u0443\u0440\u043e\u0432. \u041e\u043d\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0434\u043d\u043e \u043f\u043e\u043b\u0435 query, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u043c\u043e\u0433\u0443\u0442 \u0432\u0432\u043e\u0434\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430. \u041f\u043e\u043b\u0435 \u0438\u043c\u0435\u0435\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0443\u044e \u0434\u043b\u0438\u043d\u0443 100 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f (required=False).","title":"\u0424\u043e\u0440\u043c\u044b"},{"location":"forms/#_1","text":"","title":"\u0424\u043e\u0440\u043c\u044b"},{"location":"forms/#tourform","text":"class TourForm(forms.ModelForm): class Meta: model = Tour fields = [ 'hotel', 'stars', 'agency', 'country', 'city', 'description', 'start_date', 'end_date', 'payment_conditions', ] widgets = { 'start_date': forms.DateInput(attrs={'type': 'date'}), # \u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f start_date 'end_date': forms.DateInput(attrs={'type': 'date'}), # \u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f end_date } def clean_start_date(self): start_date = self.cleaned_data.get('start_date') today = date.today() if start_date < today: raise forms.ValidationError(\"Start date must be today or later.\") return start_date def clean_end_date(self): end_date = self.cleaned_data.get('end_date') if end_date < self.cleaned_data.get('start_date'): raise forms.ValidationError(\"End date cannot be before start date.\") return end_date \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0432\u0432\u043e\u0434\u0430 \u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0438 Tour. \u0412\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 Tour. \u041f\u043e\u043b\u044f start_date \u0438 end_date \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 HTML-\u0432\u0438\u0434\u0436\u0435\u0442 \u0441 \u0442\u0438\u043f\u043e\u043c date, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u0430 \u0434\u0430\u0442. clean_start_date: \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u0447\u0442\u043e \u0434\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 (start_date) \u043d\u0435 \u0440\u0430\u043d\u044c\u0448\u0435 \u0441\u0435\u0433\u043e\u0434\u043d\u044f\u0448\u043d\u0435\u0433\u043e \u0434\u043d\u044f. \u0415\u0441\u043b\u0438 \u0434\u0430\u0442\u0430 \u043d\u0435 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443, \u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u0430. clean_end_date: \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u0447\u0442\u043e \u0434\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f (end_date) \u043d\u0435 \u043f\u0440\u0435\u0434\u0448\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0434\u0430\u0442\u0435 \u043d\u0430\u0447\u0430\u043b\u0430. \u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u043e, \u0442\u0430\u043a\u0436\u0435 \u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u0430. \u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 Tour, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0432\u044b\u0431\u043e\u0440 \u0434\u0430\u0442 \u0447\u0435\u0440\u0435\u0437 \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0438 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043d\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c.","title":"TourForm"},{"location":"forms/#tariffform-mealoptionform","text":"class TariffForm(forms.ModelForm): class Meta: model = Tariff fields = ['name', 'price'] class MealOptionForm(forms.ModelForm): class Meta: model = MealOption fields = ['name', 'price'] # Inline formsets \u0434\u043b\u044f Tariff \u0438 MealOption TariffFormSet = inlineformset_factory( Tour, Tariff, form=TariffForm, extra=1, can_delete=True ) MealOptionFormSet = inlineformset_factory( Tour, MealOption, form=MealOptionForm, extra=1, can_delete=True ) \u041a\u043b\u0430\u0441\u0441\u044b TariffForm \u0438 MealOptionForm: \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u0444\u043e\u0440\u043c\u044b \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0435\u0439 Tariff \u0438 MealOption. \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u044e\u0442, \u0447\u0442\u043e name \u0438 price \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. TariffFormSet \u0438 MealOptionFormSet: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 inlineformset_factory \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438\u043d\u043b\u0430\u0439\u043d\u043e\u0432\u044b\u0445 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0445 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b Tariff \u0438 MealOption \u043f\u0440\u044f\u043c\u043e \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0434\u043b\u044f \u0442\u0443\u0440\u0430. \u0421\u0432\u044f\u0437\u044c \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043c\u043e\u0434\u0435\u043b\u044c Tour. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438: - form: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0444\u043e\u0440\u043c\u044b (TariffForm \u0438 MealOptionForm). - extra=1: \u041f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0432 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0434\u043d\u0430 \u043f\u0443\u0441\u0442\u0430\u044f \u0444\u043e\u0440\u043c\u0430 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e. - can_delete=True: \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 \u0444\u043e\u0440\u043c\u0443.","title":"TariffForm \u0438 MealOptionForm"},{"location":"forms/#customauthenticationform","text":"class CustomAuthenticationForm(AuthenticationForm): username = forms.CharField(widget=forms.TextInput(attrs={ 'class': 'form-control', 'placeholder': 'Username' })) password = forms.CharField(widget=forms.PasswordInput(attrs={ 'class': 'form-control', 'placeholder': 'Password' })) \u041d\u0430\u0441\u043b\u0435\u0434\u0443\u0435\u0442\u0441\u044f \u043e\u0442 AuthenticationForm \u0438 \u043a\u0430\u0441\u0442\u043e\u043c\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u043f\u043e\u043b\u044f username \u0438 password, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044f \u0441\u0442\u0438\u043b\u0438 \u0438 \u043f\u043b\u0435\u0439\u0441\u0445\u043e\u043b\u0434\u0435\u0440\u044b \u0434\u043b\u044f \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u044f \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u0432\u0438\u0434\u0430 \u0432\u0432\u043e\u0434\u0430.","title":"CustomAuthenticationForm"},{"location":"forms/#customusercreationform","text":"class CustomUserCreationForm(UserCreationForm): class Meta: model = CustomUser fields = ['username', 'email', 'password1', 'password2'] \u041d\u0430\u0441\u043b\u0435\u0434\u0443\u0435\u0442\u0441\u044f \u043e\u0442 UserCreationForm \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043f\u043e\u043b\u044f\u043c\u0438 username, email, password1, password2.","title":"CustomUserCreationForm"},{"location":"forms/#bookingform","text":"class BookingForm(forms.ModelForm): class Meta: model = Booking fields = ['num_people', 'tariff', 'meal_option'] def __init__(self, *args, **kwargs): tour = kwargs.pop('tour', None) super().__init__(*args, **kwargs) if tour: # \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u043c \u0432\u044b\u0431\u043e\u0440 \u0442\u0430\u0440\u0438\u0444\u043e\u0432 \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043f\u0438\u0442\u0430\u043d\u0438\u044f self.fields['tariff'].queryset = tour.tariffs.all() self.fields['meal_option'].queryset = tour.meal_options.all() self.fields['tariff'].widget = forms.Select( attrs={ 'class': 'tariff-select', }, choices=[(tariff.id, f'{tariff.name} - {tariff.price} RUB') for tariff in tour.tariffs.all()] ) self.fields['meal_option'].widget = forms.Select( attrs={ 'class': 'meal-select', }, choices=[(meal.id, f'{meal.name} - {meal.price} RUB') for meal in tour.meal_options.all()] ) \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0443\u0440\u0430. \u041e\u043d\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043b\u044e\u0434\u0435\u0439 (num_people), \u0442\u0430\u0440\u0438\u0444 (tariff) \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u0438\u0442\u0430\u043d\u0438\u044f (meal_option). \u0412 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440\u0435 \u0444\u043e\u0440\u043c\u044b \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430.","title":"BookingForm"},{"location":"forms/#reviewform","text":"class ReviewForm(forms.ModelForm): class Meta: model = Review fields = ['text', 'rating'] \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0442\u0437\u044b\u0432\u0430. \u041e\u043d\u0430 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0434\u0432\u0430 \u043f\u043e\u043b\u044f: \u0442\u0435\u043a\u0441\u0442 \u043e\u0442\u0437\u044b\u0432\u0430 \u0438 \u0440\u0435\u0439\u0442\u0438\u043d\u0433. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043e\u0442\u0437\u044b\u0432\u0430 \u043e \u0442\u0443\u0440\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u0442\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445.","title":"ReviewForm"},{"location":"forms/#toursearchform","text":"class TourSearchForm(forms.Form): query = forms.CharField(label='Search', max_length=100, required=False) \u041f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0430 \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u0442\u0443\u0440\u043e\u0432. \u041e\u043d\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0434\u043d\u043e \u043f\u043e\u043b\u0435 query, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u043c\u043e\u0433\u0443\u0442 \u0432\u0432\u043e\u0434\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430. \u041f\u043e\u043b\u0435 \u0438\u043c\u0435\u0435\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0443\u044e \u0434\u043b\u0438\u043d\u0443 100 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f (required=False).","title":"TourSearchForm"},{"location":"models/","text":"\u041c\u043e\u0434\u0435\u043b\u0438 \u0422\u0443\u0440\u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 class TravelAgency(models.Model): name = models.CharField(max_length=100) contact_info = models.TextField() def __str__(self): return self.name \u0425\u0440\u0430\u043d\u0438\u0442 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u0440\u043c\u044b \u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u044b. \u0422\u0443\u0440 class Tour(models.Model): hotel = models.CharField(max_length=200) stars = models.PositiveSmallIntegerField( default=3, validators=[MinValueValidator(1), MaxValueValidator(5)], help_text=\"Number of stars from 1 to 5\" ) agency = models.ForeignKey(TravelAgency, on_delete=models.CASCADE, related_name=\"tours\") country = models.CharField(max_length=200) city = models.CharField(max_length=200, null=True) description = models.TextField() start_date = models.DateField() end_date = models.DateField() payment_conditions = models.TextField() def __str__(self): return f\"{self.hotel} ({self.stars} stars) - {self.agency.name}\" def get_absolute_url(self): return reverse('tour_detail', args=[str(self.id)]) def get_base_price(self): # \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0442\u0430\u0440\u0438\u0444\u0430 \u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f tariffs = self.tariffs.all() meal_options = self.meal_options.all() if tariffs.exists() and meal_options.exists(): min_tariff_price = min(tariffs, key=lambda tariff: tariff.price).price min_meal_option_price = min(meal_options, key=lambda meal: meal.price).price return min_tariff_price + min_meal_option_price return 0 \u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0442\u0443\u0440\u0435 (\u043e\u0442\u0435\u043b\u044c, \u0435\u0433\u043e \u0437\u0432\u0435\u0437\u0434\u043d\u043e\u0441\u0442\u044c, \u0442\u0443\u0440\u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440, \u0441\u0442\u0440\u0430\u043d\u0430, \u0433\u043e\u0440\u043e\u0434, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435, \u0434\u0430\u0442\u044b, \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u043e\u043f\u043b\u0430\u0442\u044b). \u0418\u043c\u0435\u0435\u0442 \u043c\u0435\u0442\u043e\u0434 \u043f\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044e \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u043e\u0438\u043c\u0441\u0442\u0438 \u0442\u0443\u0440\u0430) \u0422\u0430\u0440\u0438\u0444 class Tariff(models.Model): tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"tariffs\") name = models.CharField(max_length=200) price = models.PositiveIntegerField(default=0) class Meta: unique_together = ('tour', 'name') def __str__(self): return f\"{self.name} - {self.price} RUB\" \u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0445 \u0434\u043b\u044f \u0442\u0443\u0440\u0430 \u0442\u0430\u0440\u0438\u0444\u0430\u0445 \u0438 \u0438\u0445 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u0438. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c. \u041e\u043f\u0446\u0438\u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f class MealOption(models.Model): tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"meal_options\") name = models.CharField(max_length=200) price = models.PositiveIntegerField(default=0) class Meta: unique_together = ('tour', 'name') def __str__(self): return f\"{self.name} - {self.price} RUB\" \u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u043b\u044f \u0442\u0443\u0440\u0430 \u043e\u043f\u0446\u0438\u044f\u0445 \u043f\u0438\u0442\u0430\u043d\u0438\u044f. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c. \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 class Booking(models.Model): user = models.ForeignKey(CustomUser, on_delete=models.CASCADE, related_name=\"bookings\") tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"bookings\") num_people = models.PositiveIntegerField(default=1) tariff = models.ForeignKey(Tariff, on_delete=models.CASCADE) meal_option = models.ForeignKey(MealOption, on_delete=models.CASCADE) is_confirmed = models.BooleanField(default=False) total_price = models.PositiveIntegerField(default=0) created = models.DateField(auto_now_add=True, null=True) def calculate_price(self): # \u0420\u0430\u0441\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u043b\u044e\u0434\u0435\u0439 tariff_price = self.tour.get_base_price() total_price = tariff_price * self.num_people return round(total_price, 3) def save(self, *args, **kwargs): self.total_price = self.calculate_price() super().save(*args, **kwargs) def __str__(self): return f\"Booking by {self.user.username} for {self.tour.hotel}\" \u0425\u0440\u0430\u043d\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0442\u0443\u0440\u0431 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0447\u0435\u043b\u043e\u0432\u0435\u043a, \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0442\u0430\u0440\u0438\u0444, \u0432\u044b\u0431\u0440\u0430\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u0438\u0442\u0430\u043d\u0438\u044f, \u0438\u0442\u043e\u0433\u043e\u0432\u0430\u044f \u0446\u0435\u043d\u0430, \u0441\u0442\u0430\u0442\u0443\u0441 \u0438 \u0432\u0440\u0435\u043c\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0431\u0440\u043e\u043d\u0438) \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c, \u0442\u0430\u0440\u0438\u0444\u043e\u043c \u0438 \u043e\u043f\u0446\u0438\u044f\u043c\u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f. \u0418\u043c\u0435\u0435\u0442 \u043c\u0435\u0442\u043e\u0434 \u0434\u043b\u044f \u043f\u043e\u0441\u0447\u0435\u0442\u0430 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. \u041e\u0442\u0437\u044b\u0432 class Review(models.Model): user = models.ForeignKey(CustomUser, on_delete=models.CASCADE, related_name=\"reviews\") tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"reviews\") date = models.DateField(auto_now_add=True) text = models.TextField() rating = models.PositiveIntegerField(default=1) def __str__(self): return f\"Review by {self.user.username} ({self.rating}/10)\" \u0425\u0440\u0430\u043d\u0438\u0442 \u043e\u0442\u0437\u044b\u0432\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c \u0438 \u0442\u0443\u0440\u043e\u043c.","title":"\u041c\u043e\u0434\u0435\u043b\u0438"},{"location":"models/#_1","text":"","title":"\u041c\u043e\u0434\u0435\u043b\u0438"},{"location":"models/#_2","text":"class TravelAgency(models.Model): name = models.CharField(max_length=100) contact_info = models.TextField() def __str__(self): return self.name \u0425\u0440\u0430\u043d\u0438\u0442 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u0440\u043c\u044b \u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u044b.","title":"\u0422\u0443\u0440\u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440"},{"location":"models/#_3","text":"class Tour(models.Model): hotel = models.CharField(max_length=200) stars = models.PositiveSmallIntegerField( default=3, validators=[MinValueValidator(1), MaxValueValidator(5)], help_text=\"Number of stars from 1 to 5\" ) agency = models.ForeignKey(TravelAgency, on_delete=models.CASCADE, related_name=\"tours\") country = models.CharField(max_length=200) city = models.CharField(max_length=200, null=True) description = models.TextField() start_date = models.DateField() end_date = models.DateField() payment_conditions = models.TextField() def __str__(self): return f\"{self.hotel} ({self.stars} stars) - {self.agency.name}\" def get_absolute_url(self): return reverse('tour_detail', args=[str(self.id)]) def get_base_price(self): # \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0442\u0430\u0440\u0438\u0444\u0430 \u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f tariffs = self.tariffs.all() meal_options = self.meal_options.all() if tariffs.exists() and meal_options.exists(): min_tariff_price = min(tariffs, key=lambda tariff: tariff.price).price min_meal_option_price = min(meal_options, key=lambda meal: meal.price).price return min_tariff_price + min_meal_option_price return 0 \u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0442\u0443\u0440\u0435 (\u043e\u0442\u0435\u043b\u044c, \u0435\u0433\u043e \u0437\u0432\u0435\u0437\u0434\u043d\u043e\u0441\u0442\u044c, \u0442\u0443\u0440\u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440, \u0441\u0442\u0440\u0430\u043d\u0430, \u0433\u043e\u0440\u043e\u0434, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435, \u0434\u0430\u0442\u044b, \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u043e\u043f\u043b\u0430\u0442\u044b). \u0418\u043c\u0435\u0435\u0442 \u043c\u0435\u0442\u043e\u0434 \u043f\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044e \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u043e\u0438\u043c\u0441\u0442\u0438 \u0442\u0443\u0440\u0430)","title":"\u0422\u0443\u0440"},{"location":"models/#_4","text":"class Tariff(models.Model): tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"tariffs\") name = models.CharField(max_length=200) price = models.PositiveIntegerField(default=0) class Meta: unique_together = ('tour', 'name') def __str__(self): return f\"{self.name} - {self.price} RUB\" \u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0445 \u0434\u043b\u044f \u0442\u0443\u0440\u0430 \u0442\u0430\u0440\u0438\u0444\u0430\u0445 \u0438 \u0438\u0445 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u0438. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c.","title":"\u0422\u0430\u0440\u0438\u0444"},{"location":"models/#_5","text":"class MealOption(models.Model): tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"meal_options\") name = models.CharField(max_length=200) price = models.PositiveIntegerField(default=0) class Meta: unique_together = ('tour', 'name') def __str__(self): return f\"{self.name} - {self.price} RUB\" \u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u043b\u044f \u0442\u0443\u0440\u0430 \u043e\u043f\u0446\u0438\u044f\u0445 \u043f\u0438\u0442\u0430\u043d\u0438\u044f. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c.","title":"\u041e\u043f\u0446\u0438\u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f"},{"location":"models/#_6","text":"class Booking(models.Model): user = models.ForeignKey(CustomUser, on_delete=models.CASCADE, related_name=\"bookings\") tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"bookings\") num_people = models.PositiveIntegerField(default=1) tariff = models.ForeignKey(Tariff, on_delete=models.CASCADE) meal_option = models.ForeignKey(MealOption, on_delete=models.CASCADE) is_confirmed = models.BooleanField(default=False) total_price = models.PositiveIntegerField(default=0) created = models.DateField(auto_now_add=True, null=True) def calculate_price(self): # \u0420\u0430\u0441\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u043b\u044e\u0434\u0435\u0439 tariff_price = self.tour.get_base_price() total_price = tariff_price * self.num_people return round(total_price, 3) def save(self, *args, **kwargs): self.total_price = self.calculate_price() super().save(*args, **kwargs) def __str__(self): return f\"Booking by {self.user.username} for {self.tour.hotel}\" \u0425\u0440\u0430\u043d\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0442\u0443\u0440\u0431 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0447\u0435\u043b\u043e\u0432\u0435\u043a, \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0442\u0430\u0440\u0438\u0444, \u0432\u044b\u0431\u0440\u0430\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u0438\u0442\u0430\u043d\u0438\u044f, \u0438\u0442\u043e\u0433\u043e\u0432\u0430\u044f \u0446\u0435\u043d\u0430, \u0441\u0442\u0430\u0442\u0443\u0441 \u0438 \u0432\u0440\u0435\u043c\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0431\u0440\u043e\u043d\u0438) \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c, \u0442\u0430\u0440\u0438\u0444\u043e\u043c \u0438 \u043e\u043f\u0446\u0438\u044f\u043c\u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f. \u0418\u043c\u0435\u0435\u0442 \u043c\u0435\u0442\u043e\u0434 \u0434\u043b\u044f \u043f\u043e\u0441\u0447\u0435\u0442\u0430 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.","title":"\u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"},{"location":"models/#_7","text":"class Review(models.Model): user = models.ForeignKey(CustomUser, on_delete=models.CASCADE, related_name=\"reviews\") tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"reviews\") date = models.DateField(auto_now_add=True) text = models.TextField() rating = models.PositiveIntegerField(default=1) def __str__(self): return f\"Review by {self.user.username} ({self.rating}/10)\" \u0425\u0440\u0430\u043d\u0438\u0442 \u043e\u0442\u0437\u044b\u0432\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c \u0438 \u0442\u0443\u0440\u043e\u043c.","title":"\u041e\u0442\u0437\u044b\u0432"},{"location":"overview/","text":"\u041b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 \u21162 \u0422\u0435\u043c\u0430 \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430 \u043d\u0430 django \u0426\u0435\u043b\u044c \u0440\u0430\u0431\u043e\u0442\u044b \u041e\u0432\u043b\u0430\u0434\u0435\u0442\u044c \u043f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u043c\u0438 \u043d\u0430\u0432\u044b\u043a\u0430\u043c\u0438 \u0438 \u0443\u043c\u0435\u043d\u0438\u044f\u043c\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 web-\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438 Django 3 \u0438 PostgreSQL. \u0417\u0430\u0434\u0430\u0447\u0430 \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0430\u0439\u0442 \u0442\u0443\u0440\u0444\u0438\u0440\u043c\u044b \u0441\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u043e\u043c: - \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. - \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u043e\u0432. \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0438\u043c\u0435\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0441\u0432\u043e\u0438\u0445 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439. - \u041d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043a \u0442\u0443\u0440\u0430\u043c. - \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 \u0438\u043c\u0435\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438 Django-admin. - \u0412 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430, \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0449\u0430\u044f \u0432\u0441\u0435 \u043f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0443\u0440\u044b \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c. \u0417\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u043e\u0435\u043a\u0442\u0430 python manage.py runserver","title":"\u041b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 \u21162"},{"location":"overview/#no2","text":"","title":"\u041b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 \u21162"},{"location":"overview/#_1","text":"\u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430 \u043d\u0430 django","title":"\u0422\u0435\u043c\u0430"},{"location":"overview/#_2","text":"\u041e\u0432\u043b\u0430\u0434\u0435\u0442\u044c \u043f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u043c\u0438 \u043d\u0430\u0432\u044b\u043a\u0430\u043c\u0438 \u0438 \u0443\u043c\u0435\u043d\u0438\u044f\u043c\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 web-\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438 Django 3 \u0438 PostgreSQL.","title":"\u0426\u0435\u043b\u044c \u0440\u0430\u0431\u043e\u0442\u044b"},{"location":"overview/#_3","text":"\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0430\u0439\u0442 \u0442\u0443\u0440\u0444\u0438\u0440\u043c\u044b \u0441\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u043e\u043c: - \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. - \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u043e\u0432. \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0438\u043c\u0435\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0441\u0432\u043e\u0438\u0445 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439. - \u041d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043a \u0442\u0443\u0440\u0430\u043c. - \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 \u0438\u043c\u0435\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438 Django-admin. - \u0412 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430, \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0449\u0430\u044f \u0432\u0441\u0435 \u043f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0443\u0440\u044b \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c.","title":"\u0417\u0430\u0434\u0430\u0447\u0430"},{"location":"overview/#_4","text":"python manage.py runserver","title":"\u0417\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u043e\u0435\u043a\u0442\u0430"},{"location":"urls/","text":"\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u044b urlpatterns = [ # \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f path('register/', views.register, name='register'), path('', login_view, name='login'), path('logout/', logout_view, name='logout'), # \u0422\u0443\u0440\u044b path('tours/', views.tour_list, name='tour_list'), path('tours/<int:pk>/', views.tour_detail, name='tour_detail'), path('tours/<int:tour_id>/book/', views.book_tour, name='book_tour'), path('tours/<int:pk>/add_review/', views.add_review, name='add_review'), # \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f path('my_bookings/', views.my_bookings, name='my_bookings'), path('my_bookings/<int:pk>/edit', BookingUpdateView.as_view(), name='edit_booking'), path('my_bookings/<int:pk>/delete', BookingDeleteView.as_view(), name='delete_booking'), path('bookings/<int:pk>/', BookingDetailView.as_view(), name='booking_detail'), # \u0410\u0434\u043c\u0438\u043d path('add_tour/', views.add_tour, name='add_tour'), path('edit_tour/<int:pk>/', views.edit_tour, name='edit_tour'), path('view_bookings/', views.view_bookings, name='view_bookings'), path('confirm_booking/<int:pk>/', views.confirm_booking, name='confirm_booking'), path('tour_sales_statistics/', views.sold_tours_by_country, name='tour_sales_statistics'), ] \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f: - register/: \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. - login/: \u0412\u0445\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. - logout/: \u0412\u044b\u0445\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. - \u0422\u0443\u0440\u044b: - tours/: \u0421\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0442\u0443\u0440\u043e\u0432. - tours/ /: \u0414\u0435\u0442\u0430\u043b\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - tours/ /book/: \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - tours/ /add_review/: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u0437\u044b\u0432\u0430 \u043a \u0442\u0443\u0440\u0443. - \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: - my_bookings/: \u041c\u043e\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - my_bookings/ /edit: \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - my_bookings/ /delete: \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - bookings/ /: \u0414\u0435\u0442\u0430\u043b\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - \u0410\u0434\u043c\u0438\u043d: - add_tour/: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - edit_tour/ /: \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0442\u0443\u0440\u0430. - view_bookings/: \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0432\u0441\u0435\u0445 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439. - confirm_booking/ /: \u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - tour_sales_statistics/: \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u043f\u0440\u043e\u0434\u0430\u0436\u0430\u043c \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c.","title":"\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u044b"},{"location":"urls/#_1","text":"urlpatterns = [ # \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f path('register/', views.register, name='register'), path('', login_view, name='login'), path('logout/', logout_view, name='logout'), # \u0422\u0443\u0440\u044b path('tours/', views.tour_list, name='tour_list'), path('tours/<int:pk>/', views.tour_detail, name='tour_detail'), path('tours/<int:tour_id>/book/', views.book_tour, name='book_tour'), path('tours/<int:pk>/add_review/', views.add_review, name='add_review'), # \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f path('my_bookings/', views.my_bookings, name='my_bookings'), path('my_bookings/<int:pk>/edit', BookingUpdateView.as_view(), name='edit_booking'), path('my_bookings/<int:pk>/delete', BookingDeleteView.as_view(), name='delete_booking'), path('bookings/<int:pk>/', BookingDetailView.as_view(), name='booking_detail'), # \u0410\u0434\u043c\u0438\u043d path('add_tour/', views.add_tour, name='add_tour'), path('edit_tour/<int:pk>/', views.edit_tour, name='edit_tour'), path('view_bookings/', views.view_bookings, name='view_bookings'), path('confirm_booking/<int:pk>/', views.confirm_booking, name='confirm_booking'), path('tour_sales_statistics/', views.sold_tours_by_country, name='tour_sales_statistics'), ] \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f: - register/: \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. - login/: \u0412\u0445\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. - logout/: \u0412\u044b\u0445\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. - \u0422\u0443\u0440\u044b: - tours/: \u0421\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0442\u0443\u0440\u043e\u0432. - tours/ /: \u0414\u0435\u0442\u0430\u043b\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - tours/ /book/: \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - tours/ /add_review/: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u0437\u044b\u0432\u0430 \u043a \u0442\u0443\u0440\u0443. - \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: - my_bookings/: \u041c\u043e\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - my_bookings/ /edit: \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - my_bookings/ /delete: \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - bookings/ /: \u0414\u0435\u0442\u0430\u043b\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - \u0410\u0434\u043c\u0438\u043d: - add_tour/: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - edit_tour/ /: \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0442\u0443\u0440\u0430. - view_bookings/: \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0432\u0441\u0435\u0445 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439. - confirm_booking/ /: \u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - tour_sales_statistics/: \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u043f\u0440\u043e\u0434\u0430\u0436\u0430\u043c \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c.","title":"\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u044b"},{"location":"views/","text":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f class TravelAgency(models.Model): name = models.CharField(max_length=100) contact_info = models.TextField() def __str__(self): return self.name \u041e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0432\u0445\u043e\u0434\u0430. \u0412\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 def login_view(request): if request.method == 'POST': form = AuthenticationForm(data=request.POST) if form.is_valid(): user = form.get_user() login(request, user) return redirect('tour_list') else: form = AuthenticationForm() return render(request, 'login.html', {'form': form}) \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0443 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043e\u0442\u0435\u043b\u0435\u0439. \u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b @login_required def logout_view(request): logout(request) return redirect('login') \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0432\u0445\u043e\u0434\u0430. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439. \u0421\u043f\u0438\u0441\u043e\u043a \u0442\u0443\u0440\u043e\u0432 def tour_list(request): form = TourSearchForm(request.GET) tours = Tour.objects.all() if form.is_valid(): query = form.cleaned_data['query'] if query: # \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c Q \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u043f\u043e\u043b\u044f\u043c tours = tours.filter( Q(hotel__icontains=query) | Q(country__icontains=query) | Q(city__icontains=query) | Q(description__icontains=query) ) paginator = Paginator(tours, 5) page_number = request.GET.get('page') page_obj = paginator.get_page(page_number) return render(request, 'tour_list.html', {'page_obj': page_obj, 'form': form}) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0432\u0441\u0435 \u0438\u043c\u0435\u044e\u0449\u0438\u0435\u0441\u044f \u0442\u0443\u0440\u044b. \u0422\u0430\u043a \u0436\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0432\u0435\u0440\u0448\u0430\u0442\u044c \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0442\u0443\u0440\u0430\u043c (\u043f\u043e \u043f\u043e\u043b\u044f\u043c \u043e\u0442\u0435\u043b\u044c, \u0441\u0442\u0440\u0430\u043d\u0430, \u0433\u043e\u0440\u043e\u0434 \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435). \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u044e \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435. \u0414\u0435\u0442\u0430\u043b\u0438 \u0442\u0443\u0440\u0430 def tour_detail(request, pk): tour = get_object_or_404(Tour, pk=pk) nights = (tour.end_date - tour.start_date).days return render(request, 'tour_detail.html', {'tour': tour, 'nights': nights}) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0435\u0442\u0430\u043b\u0438 \u0442\u0443\u0440\u0430 \u0438\u0437 \u043c\u043e\u0434\u0435\u043b\u0438, \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u0434\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0442\u0443\u0440\u0430. \u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 @login_required def book_tour(request, tour_id): tour = get_object_or_404(Tour, id=tour_id) if request.method == 'POST': form = BookingForm(request.POST, tour=tour) print(form.is_valid()) if form.is_valid(): booking = form.save(commit=False) booking.tour = tour booking.user = request.user booking.save() print(booking) return redirect('my_bookings') else: form = BookingForm(tour=tour) return render(request, 'book_tour.html', {'form': form, 'tour': tour}) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b, \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u044c \u043d\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0439 \u0442\u0443\u0440 \u0438 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0435\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439. \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f class BookingUpdateView(UpdateView): model = Booking form_class = BookingForm template_name = 'update_booking.html' success_url = reverse_lazy('my_bookings') def get_form_kwargs(self): kwargs = super().get_form_kwargs() kwargs['tour'] = self.object.tour return kwargs def get_context_data(self, **kwargs): context = super().get_context_data(**kwargs) context['title'] = 'Edit Booking' context['total_price'] = self.object.total_price return context \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0431\u0440\u043e\u043d\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u041f\u0440\u0438 \u0443\u0441\u043f\u0435\u0445\u0435 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0435\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f class BookingDeleteView(DeleteView): model = Booking template_name = 'delete_booking.html' success_url = reverse_lazy('my_bookings') title = 'Booking Cancellation' \u0423\u0434\u0430\u043b\u044f\u0435\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435. \u041f\u0440\u0438 \u0443\u0441\u043f\u0435\u0445\u0435 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439. \u0414\u0435\u0442\u0430\u043b\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f class BookingDetailView(DetailView): model = Booking template_name = 'booking_detail.html' context_object_name = 'booking' \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0431\u0440\u043e\u043d\u0438. \u041c\u043e\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f @login_required def my_bookings(request): bookings = request.user.bookings.all() return render(request, 'my_bookings.html', {'bookings': bookings}) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0432\u0441\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u041e\u0442\u0437\u044b\u0432\u044b @login_required def add_review(request, pk): tour = get_object_or_404(Tour, pk=pk) if not request.user.bookings.filter(tour=tour, is_confirmed=True).exists(): return redirect('my_bookings', pk=pk) if request.method == 'POST': form = ReviewForm(request.POST) if form.is_valid(): review = form.save(commit=False) review.user = request.user review.tour = tour review.save() return redirect('tour_detail', pk=pk) else: form = ReviewForm() return render(request, 'add_review.html', {'form': form, 'tour': tour}) \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u043e\u0442\u0437\u044b\u0432 \u043d\u0430 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u0443\u044e \u0431\u0440\u043e\u043d\u044c. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 @admin_required def add_tour(request): if request.method == 'POST': form = TourForm(request.POST) if form.is_valid(): # \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 \u043f\u0435\u0440\u0435\u0434 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432 tour = form.save(commit=False) tour.save() # \u041f\u0440\u0438\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d\u043d\u044b\u0439 \u0442\u0443\u0440 \u043a \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u0430\u043c tariff_formset = TariffFormSet(request.POST, instance=tour) meal_option_formset = MealOptionFormSet(request.POST, instance=tour) if tariff_formset.is_valid() and meal_option_formset.is_valid(): tariff_formset.save() meal_option_formset.save() return redirect('tour_list') else: # \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0443\u0441\u0442\u044b\u0445 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432 \u043f\u0440\u0438 \u043e\u0448\u0438\u0431\u043a\u0435 \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0444\u043e\u0440\u043c\u0435 tariff_formset = TariffFormSet(instance=form.instance) meal_option_formset = MealOptionFormSet(instance=form.instance) else: # \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0443\u0441\u0442\u044b\u0445 \u0444\u043e\u0440\u043c form = TourForm() tariff_formset = TariffFormSet(instance=Tour()) meal_option_formset = MealOptionFormSet(instance=Tour()) return render(request, 'add_tour.html', { 'form': form, 'tariff_formset': tariff_formset, 'meal_option_formset': meal_option_formset, }) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b, \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0443\u0440 \u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430. \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 @admin_required def edit_tour(request, pk): tour = get_object_or_404(Tour, pk=pk) if request.method == 'POST': form = TourForm(request.POST, instance=tour) tariff_formset = TariffFormSet(request.POST, instance=tour) meal_option_formset = MealOptionFormSet(request.POST, instance=tour) if form.is_valid() and tariff_formset.is_valid() and meal_option_formset.is_valid(): # \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0442\u0443\u0440\u0435 form.save() for tariff in tariff_formset.save(commit=False): tariff.tour = tour tariff.save() # \u0423\u0434\u0430\u043b\u044f\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u0430\u0440\u0438\u0444\u044b for tariff in tariff_formset.deleted_objects: tariff.delete() for meal_option in meal_option_formset.save(commit=False): meal_option.tour = tour meal_option.save() # \u0423\u0434\u0430\u043b\u044f\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f for meal_option in meal_option_formset.deleted_objects: meal_option.delete() return redirect('tour_list') else: form = TourForm(instance=tour) tariff_formset = TariffFormSet(instance=tour) meal_option_formset = MealOptionFormSet(instance=tour) return render(request, 'edit_tour.html', { 'form': form, 'tariff_formset': tariff_formset, 'meal_option_formset': meal_option_formset, }) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0442\u0443\u0440\u0435, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u043e\u043f\u0446\u0438\u0438 \u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u043e\u0435. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430. \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u043e\u043c @admin_required def view_bookings(request): bookings = Booking.objects.all() return render(request, 'view_bookings.html', {'bookings': bookings}) \u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430. \u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 @admin_required def confirm_booking(request, pk): booking = get_object_or_404(Booking, pk=pk) booking.is_confirmed = True booking.save() return redirect('view_bookings') \u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430. \u041f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0443\u0440\u044b \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c @admin_required def sold_tours_by_country(request): tours_by_country = ( Tour.objects.filter(bookings__is_confirmed=True) .values('country') .annotate(total_bookings=Count('bookings')) .order_by('-total_bookings') ) return render(request, 'sold_tours.html', {'tours_by_country': tours_by_country}) \u0424\u0438\u043b\u044c\u0442\u0440\u0443\u0435\u0442 \u0442\u0443\u0440\u044b \u0438 \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c \u0438 \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u0445 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u044b. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.","title":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f"},{"location":"views/#_1","text":"","title":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f"},{"location":"views/#_2","text":"class TravelAgency(models.Model): name = models.CharField(max_length=100) contact_info = models.TextField() def __str__(self): return self.name \u041e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0432\u0445\u043e\u0434\u0430.","title":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"},{"location":"views/#_3","text":"def login_view(request): if request.method == 'POST': form = AuthenticationForm(data=request.POST) if form.is_valid(): user = form.get_user() login(request, user) return redirect('tour_list') else: form = AuthenticationForm() return render(request, 'login.html', {'form': form}) \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0443 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043e\u0442\u0435\u043b\u0435\u0439.","title":"\u0412\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443"},{"location":"views/#_4","text":"@login_required def logout_view(request): logout(request) return redirect('login') \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0432\u0445\u043e\u0434\u0430. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439.","title":"\u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b"},{"location":"views/#_5","text":"def tour_list(request): form = TourSearchForm(request.GET) tours = Tour.objects.all() if form.is_valid(): query = form.cleaned_data['query'] if query: # \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c Q \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u043f\u043e\u043b\u044f\u043c tours = tours.filter( Q(hotel__icontains=query) | Q(country__icontains=query) | Q(city__icontains=query) | Q(description__icontains=query) ) paginator = Paginator(tours, 5) page_number = request.GET.get('page') page_obj = paginator.get_page(page_number) return render(request, 'tour_list.html', {'page_obj': page_obj, 'form': form}) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0432\u0441\u0435 \u0438\u043c\u0435\u044e\u0449\u0438\u0435\u0441\u044f \u0442\u0443\u0440\u044b. \u0422\u0430\u043a \u0436\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0432\u0435\u0440\u0448\u0430\u0442\u044c \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0442\u0443\u0440\u0430\u043c (\u043f\u043e \u043f\u043e\u043b\u044f\u043c \u043e\u0442\u0435\u043b\u044c, \u0441\u0442\u0440\u0430\u043d\u0430, \u0433\u043e\u0440\u043e\u0434 \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435). \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u044e \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435.","title":"\u0421\u043f\u0438\u0441\u043e\u043a \u0442\u0443\u0440\u043e\u0432"},{"location":"views/#_6","text":"def tour_detail(request, pk): tour = get_object_or_404(Tour, pk=pk) nights = (tour.end_date - tour.start_date).days return render(request, 'tour_detail.html', {'tour': tour, 'nights': nights}) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0435\u0442\u0430\u043b\u0438 \u0442\u0443\u0440\u0430 \u0438\u0437 \u043c\u043e\u0434\u0435\u043b\u0438, \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u0434\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0442\u0443\u0440\u0430.","title":"\u0414\u0435\u0442\u0430\u043b\u0438 \u0442\u0443\u0440\u0430"},{"location":"views/#_7","text":"@login_required def book_tour(request, tour_id): tour = get_object_or_404(Tour, id=tour_id) if request.method == 'POST': form = BookingForm(request.POST, tour=tour) print(form.is_valid()) if form.is_valid(): booking = form.save(commit=False) booking.tour = tour booking.user = request.user booking.save() print(booking) return redirect('my_bookings') else: form = BookingForm(tour=tour) return render(request, 'book_tour.html', {'form': form, 'tour': tour}) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b, \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u044c \u043d\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0439 \u0442\u0443\u0440 \u0438 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0435\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439.","title":"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430"},{"location":"views/#_8","text":"class BookingUpdateView(UpdateView): model = Booking form_class = BookingForm template_name = 'update_booking.html' success_url = reverse_lazy('my_bookings') def get_form_kwargs(self): kwargs = super().get_form_kwargs() kwargs['tour'] = self.object.tour return kwargs def get_context_data(self, **kwargs): context = super().get_context_data(**kwargs) context['title'] = 'Edit Booking' context['total_price'] = self.object.total_price return context \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0431\u0440\u043e\u043d\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u041f\u0440\u0438 \u0443\u0441\u043f\u0435\u0445\u0435 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0435\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.","title":"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"},{"location":"views/#_9","text":"class BookingDeleteView(DeleteView): model = Booking template_name = 'delete_booking.html' success_url = reverse_lazy('my_bookings') title = 'Booking Cancellation' \u0423\u0434\u0430\u043b\u044f\u0435\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435. \u041f\u0440\u0438 \u0443\u0441\u043f\u0435\u0445\u0435 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439.","title":"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"},{"location":"views/#_10","text":"class BookingDetailView(DetailView): model = Booking template_name = 'booking_detail.html' context_object_name = 'booking' \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0431\u0440\u043e\u043d\u0438.","title":"\u0414\u0435\u0442\u0430\u043b\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"},{"location":"views/#_11","text":"@login_required def my_bookings(request): bookings = request.user.bookings.all() return render(request, 'my_bookings.html', {'bookings': bookings}) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0432\u0441\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.","title":"\u041c\u043e\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"},{"location":"views/#_12","text":"@login_required def add_review(request, pk): tour = get_object_or_404(Tour, pk=pk) if not request.user.bookings.filter(tour=tour, is_confirmed=True).exists(): return redirect('my_bookings', pk=pk) if request.method == 'POST': form = ReviewForm(request.POST) if form.is_valid(): review = form.save(commit=False) review.user = request.user review.tour = tour review.save() return redirect('tour_detail', pk=pk) else: form = ReviewForm() return render(request, 'add_review.html', {'form': form, 'tour': tour}) \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u043e\u0442\u0437\u044b\u0432 \u043d\u0430 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u0443\u044e \u0431\u0440\u043e\u043d\u044c. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.","title":"\u041e\u0442\u0437\u044b\u0432\u044b"},{"location":"views/#_13","text":"@admin_required def add_tour(request): if request.method == 'POST': form = TourForm(request.POST) if form.is_valid(): # \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 \u043f\u0435\u0440\u0435\u0434 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432 tour = form.save(commit=False) tour.save() # \u041f\u0440\u0438\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d\u043d\u044b\u0439 \u0442\u0443\u0440 \u043a \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u0430\u043c tariff_formset = TariffFormSet(request.POST, instance=tour) meal_option_formset = MealOptionFormSet(request.POST, instance=tour) if tariff_formset.is_valid() and meal_option_formset.is_valid(): tariff_formset.save() meal_option_formset.save() return redirect('tour_list') else: # \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0443\u0441\u0442\u044b\u0445 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432 \u043f\u0440\u0438 \u043e\u0448\u0438\u0431\u043a\u0435 \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0444\u043e\u0440\u043c\u0435 tariff_formset = TariffFormSet(instance=form.instance) meal_option_formset = MealOptionFormSet(instance=form.instance) else: # \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0443\u0441\u0442\u044b\u0445 \u0444\u043e\u0440\u043c form = TourForm() tariff_formset = TariffFormSet(instance=Tour()) meal_option_formset = MealOptionFormSet(instance=Tour()) return render(request, 'add_tour.html', { 'form': form, 'tariff_formset': tariff_formset, 'meal_option_formset': meal_option_formset, }) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b, \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0443\u0440 \u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.","title":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0443\u0440\u0430"},{"location":"views/#_14","text":"@admin_required def edit_tour(request, pk): tour = get_object_or_404(Tour, pk=pk) if request.method == 'POST': form = TourForm(request.POST, instance=tour) tariff_formset = TariffFormSet(request.POST, instance=tour) meal_option_formset = MealOptionFormSet(request.POST, instance=tour) if form.is_valid() and tariff_formset.is_valid() and meal_option_formset.is_valid(): # \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0442\u0443\u0440\u0435 form.save() for tariff in tariff_formset.save(commit=False): tariff.tour = tour tariff.save() # \u0423\u0434\u0430\u043b\u044f\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u0430\u0440\u0438\u0444\u044b for tariff in tariff_formset.deleted_objects: tariff.delete() for meal_option in meal_option_formset.save(commit=False): meal_option.tour = tour meal_option.save() # \u0423\u0434\u0430\u043b\u044f\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f for meal_option in meal_option_formset.deleted_objects: meal_option.delete() return redirect('tour_list') else: form = TourForm(instance=tour) tariff_formset = TariffFormSet(instance=tour) meal_option_formset = MealOptionFormSet(instance=tour) return render(request, 'edit_tour.html', { 'form': form, 'tariff_formset': tariff_formset, 'meal_option_formset': meal_option_formset, }) \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0442\u0443\u0440\u0435, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u043e\u043f\u0446\u0438\u0438 \u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u043e\u0435. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.","title":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430"},{"location":"views/#_15","text":"@admin_required def view_bookings(request): bookings = Booking.objects.all() return render(request, 'view_bookings.html', {'bookings': bookings}) \u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.","title":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u043e\u043c"},{"location":"views/#_16","text":"@admin_required def confirm_booking(request, pk): booking = get_object_or_404(Booking, pk=pk) booking.is_confirmed = True booking.save() return redirect('view_bookings') \u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.","title":"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"},{"location":"views/#_17","text":"@admin_required def sold_tours_by_country(request): tours_by_country = ( Tour.objects.filter(bookings__is_confirmed=True) .values('country') .annotate(total_bookings=Count('bookings')) .order_by('-total_bookings') ) return render(request, 'sold_tours.html', {'tours_by_country': tours_by_country}) \u0424\u0438\u043b\u044c\u0442\u0440\u0443\u0435\u0442 \u0442\u0443\u0440\u044b \u0438 \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c \u0438 \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u0445 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u044b. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.","title":"\u041f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0443\u0440\u044b \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c"}]}
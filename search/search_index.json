{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"WEB-\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 2","text":"<p>\u041b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 2. \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430 \u043d\u0430 django.</p>"},{"location":"#_1","title":"\u0421\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435","text":"<ul> <li>\u0417\u0430\u0434\u0430\u043d\u0438\u0435</li> <li>\u041c\u043e\u0434\u0435\u043b\u0438</li> <li>\u0424\u043e\u0440\u043c\u044b</li> <li>\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f</li> <li>\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u044b</li> </ul>"},{"location":"admin/","title":"\u0410\u0434\u043c\u0438\u043d \u043f\u0430\u043d\u0435\u043b\u044c","text":""},{"location":"admin/#customuser","title":"CustomUser","text":"<ul> <li>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0438 \u043f\u0440\u0430\u0432\u0430\u043c \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.</li> <li>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u0435 \u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0439 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438.</li> </ul> <pre><code>@admin.register(CustomUser)\nclass CustomUserAdmin(admin.ModelAdmin):\n    list_display = ('username', 'email', 'is_staff', 'is_active')\n    list_filter = ('is_staff', 'is_active')\n    search_fields = ('username', 'email')\n</code></pre>"},{"location":"admin/#travelagency","title":"TravelAgency","text":"<ul> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430.</li> <li>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430.</li> </ul> <pre><code>@admin.register(TravelAgency)\nclass TravelAgencyAdmin(admin.ModelAdmin):\n    list_display = ('name', 'contact_info')\n    search_fields = ('name',)\n    ordering = ('name',)\n</code></pre>"},{"location":"admin/#tour","title":"Tour","text":"<ul> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0437\u0432\u0435\u0437\u0434, \u0441\u0442\u0440\u0430\u043d\u0435 \u0438 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0443.</li> <li>\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f, \u0433\u043e\u0440\u043e\u0434\u0443 \u0438 \u0441\u0442\u0440\u0430\u043d\u0435 \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438.</li> <li>\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 \u043d\u0430\u0447\u0430\u043b\u0430.</li> </ul> <pre><code>@admin.register(Tour)\nclass TourAdmin(admin.ModelAdmin):\n    list_display = ('hotel', 'stars', 'agency', 'country', 'city', 'start_date', 'end_date')\n    list_filter = ('stars', 'country', 'agency')\n    search_fields = ('hotel', 'country', 'city')\n    ordering = ('start_date',)\n\n</code></pre>"},{"location":"admin/#tariff","title":"Tariff","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u0442\u0443\u0440\u0443.</li> <li>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0442\u0430\u0440\u0438\u0444\u0430.</li> <li>\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0442\u0430\u0440\u0438\u0444\u043e\u0432 \u043f\u043e \u0446\u0435\u043d\u0435.</li> </ul> <pre><code>@admin.register(Tariff)\nclass TariffAdmin(admin.ModelAdmin):\n    list_display = ('name', 'price', 'tour')\n    list_filter = ('tour',)\n    search_fields = ('name',)\n    ordering = ('price',)\n</code></pre>"},{"location":"admin/#mealoption","title":"MealOption","text":"<ul> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u043f\u043e \u0442\u0443\u0440\u0443.</li> <li>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0430 \u043f\u0438\u0442\u0430\u043d\u0438\u044f.</li> <li>\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e \u0446\u0435\u043d\u0435.</li> </ul> <pre><code>@admin.register(MealOption)\nclass MealOptionAdmin(admin.ModelAdmin):\n    list_display = ('name', 'price', 'tour')\n    list_filter = ('tour',)\n    search_fields = ('name',)\n    ordering = ('price',)\n</code></pre>"},{"location":"admin/#booking","title":"Booking","text":"<ul> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f, \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u0442\u0443\u0440\u0443.</li> <li>\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f.</li> <li>\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f (\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u043a \u0441\u0442\u0430\u0440\u044b\u043c).</li> </ul> <pre><code>@admin.register(Booking)\nclass BookingAdmin(admin.ModelAdmin):\n    list_display = ('user', 'tour', 'num_people', 'tariff', 'meal_option', 'is_confirmed', 'total_price', 'created')\n    list_filter = ('is_confirmed', 'created', 'tour')\n    search_fields = ('user__username', 'tour__hotel')\n    ordering = ('-created',)\n</code></pre>"},{"location":"admin/#review","title":"Review","text":"<ul> <li>\u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043f\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0443, \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u0442\u0443\u0440\u0443.</li> <li>\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u0435\u043b\u044f \u0438 \u0442\u0435\u043a\u0441\u0442\u0443 \u043e\u0442\u0437\u044b\u0432\u0430.</li> <li>\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 (\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u043a \u0441\u0442\u0430\u0440\u044b\u043c).</li> </ul> <pre><code>@admin.register(Review)\nclass ReviewAdmin(admin.ModelAdmin):\n    list_display = ('user', 'tour', 'rating', 'date', 'text')\n    list_filter = ('rating', 'date', 'tour')\n    search_fields = ('user__username', 'tour__hotel', 'text')\n    ordering = ('-date',)\n</code></pre>"},{"location":"forms/","title":"\u0424\u043e\u0440\u043c\u044b","text":""},{"location":"forms/#tourform","title":"TourForm","text":"<pre><code>class TourForm(forms.ModelForm):\n    class Meta:\n        model = Tour\n        fields = [\n            'hotel',\n            'stars',\n            'agency',\n            'country',\n            'city',\n            'description',\n            'start_date',\n            'end_date',\n            'payment_conditions',\n        ]\n        widgets = {\n            'start_date': forms.DateInput(attrs={'type': 'date'}),  # \u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f start_date\n            'end_date': forms.DateInput(attrs={'type': 'date'}),    # \u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f end_date\n        }\n\n    def clean_start_date(self):\n        start_date = self.cleaned_data.get('start_date')\n        today = date.today()\n        if start_date &lt; today:\n            raise forms.ValidationError(\"Start date must be today or later.\")\n        return start_date\n\n    def clean_end_date(self):\n        end_date = self.cleaned_data.get('end_date')\n        if end_date &lt; self.cleaned_data.get('start_date'):\n            raise forms.ValidationError(\"End date cannot be before start date.\")\n        return end_date\n</code></pre> <ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0432\u0432\u043e\u0434\u0430 \u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0438 Tour.</li> <li>\u0412\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 Tour.</li> <li>\u041f\u043e\u043b\u044f start_date \u0438 end_date \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 HTML-\u0432\u0438\u0434\u0436\u0435\u0442 \u0441 \u0442\u0438\u043f\u043e\u043c date, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u0430 \u0434\u0430\u0442.</li> <li>clean_start_date: \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u0447\u0442\u043e \u0434\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 (start_date) \u043d\u0435 \u0440\u0430\u043d\u044c\u0448\u0435 \u0441\u0435\u0433\u043e\u0434\u043d\u044f\u0448\u043d\u0435\u0433\u043e \u0434\u043d\u044f. \u0415\u0441\u043b\u0438 \u0434\u0430\u0442\u0430 \u043d\u0435 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443, \u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u0430.</li> <li>clean_end_date: \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u0447\u0442\u043e \u0434\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f (end_date) \u043d\u0435 \u043f\u0440\u0435\u0434\u0448\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0434\u0430\u0442\u0435 \u043d\u0430\u0447\u0430\u043b\u0430. \u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u043e, \u0442\u0430\u043a\u0436\u0435 \u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u0430.</li> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0432\u0432\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 Tour, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0432\u044b\u0431\u043e\u0440 \u0434\u0430\u0442 \u0447\u0435\u0440\u0435\u0437 \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0438 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043d\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c.</li> </ul>"},{"location":"forms/#tariffform-mealoptionform","title":"TariffForm \u0438 MealOptionForm","text":"<pre><code>class TariffForm(forms.ModelForm):\n    class Meta:\n        model = Tariff\n        fields = ['name', 'price']\n\n\nclass MealOptionForm(forms.ModelForm):\n    class Meta:\n        model = MealOption\n        fields = ['name', 'price']\n\n\n# Inline formsets \u0434\u043b\u044f Tariff \u0438 MealOption\nTariffFormSet = inlineformset_factory(\n    Tour, Tariff, form=TariffForm, extra=1, can_delete=True\n)\nMealOptionFormSet = inlineformset_factory(\n    Tour, MealOption, form=MealOptionForm, extra=1, can_delete=True\n)\n</code></pre> <p>\u041a\u043b\u0430\u0441\u0441\u044b TariffForm \u0438 MealOptionForm:</p> <ul> <li>\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u0444\u043e\u0440\u043c\u044b \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0435\u0439 Tariff \u0438 MealOption.</li> <li>\u0423\u043a\u0430\u0437\u044b\u0432\u0430\u044e\u0442, \u0447\u0442\u043e name \u0438 price \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> <li>TariffFormSet \u0438 MealOptionFormSet:</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 inlineformset_factory \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438\u043d\u043b\u0430\u0439\u043d\u043e\u0432\u044b\u0445 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0445 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b Tariff \u0438 MealOption \u043f\u0440\u044f\u043c\u043e \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0434\u043b\u044f \u0442\u0443\u0440\u0430.</li> <li>\u0421\u0432\u044f\u0437\u044c \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043c\u043e\u0434\u0435\u043b\u044c Tour.</li> </ul> <p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438: - form: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0444\u043e\u0440\u043c\u044b (TariffForm \u0438 MealOptionForm). - extra=1: \u041f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0432 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0434\u043d\u0430 \u043f\u0443\u0441\u0442\u0430\u044f \u0444\u043e\u0440\u043c\u0430 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e. - can_delete=True: \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 \u0444\u043e\u0440\u043c\u0443.</p>"},{"location":"forms/#customauthenticationform","title":"CustomAuthenticationForm","text":"<pre><code>class CustomAuthenticationForm(AuthenticationForm):\n    username = forms.CharField(widget=forms.TextInput(attrs={\n        'class': 'form-control',\n        'placeholder': 'Username'\n    }))\n    password = forms.CharField(widget=forms.PasswordInput(attrs={\n        'class': 'form-control',\n        'placeholder': 'Password'\n    }))\n</code></pre> <p>\u041d\u0430\u0441\u043b\u0435\u0434\u0443\u0435\u0442\u0441\u044f \u043e\u0442 AuthenticationForm \u0438 \u043a\u0430\u0441\u0442\u043e\u043c\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u043f\u043e\u043b\u044f username \u0438 password, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044f \u0441\u0442\u0438\u043b\u0438 \u0438 \u043f\u043b\u0435\u0439\u0441\u0445\u043e\u043b\u0434\u0435\u0440\u044b \u0434\u043b\u044f \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u044f \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u0432\u0438\u0434\u0430 \u0432\u0432\u043e\u0434\u0430.</p>"},{"location":"forms/#customusercreationform","title":"CustomUserCreationForm","text":"<pre><code>class CustomUserCreationForm(UserCreationForm):\n    class Meta:\n        model = CustomUser\n        fields = ['username', 'email', 'password1', 'password2']\n</code></pre> <p>\u041d\u0430\u0441\u043b\u0435\u0434\u0443\u0435\u0442\u0441\u044f \u043e\u0442 UserCreationForm \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043f\u043e\u043b\u044f\u043c\u0438 username, email, password1, password2.</p>"},{"location":"forms/#bookingform","title":"BookingForm","text":"<pre><code>class BookingForm(forms.ModelForm):\n    class Meta:\n        model = Booking\n        fields = ['num_people', 'tariff', 'meal_option']\n\n    def __init__(self, *args, **kwargs):\n        tour = kwargs.pop('tour', None)\n        super().__init__(*args, **kwargs)\n\n        if tour:\n            # \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u043c \u0432\u044b\u0431\u043e\u0440 \u0442\u0430\u0440\u0438\u0444\u043e\u0432 \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043f\u0438\u0442\u0430\u043d\u0438\u044f\n            self.fields['tariff'].queryset = tour.tariffs.all()\n            self.fields['meal_option'].queryset = tour.meal_options.all()\n\n            self.fields['tariff'].widget = forms.Select(\n                attrs={\n                    'class': 'tariff-select',\n                },\n                choices=[(tariff.id, f'{tariff.name} - {tariff.price} RUB') for tariff in tour.tariffs.all()]\n            )\n            self.fields['meal_option'].widget = forms.Select(\n                attrs={\n                    'class': 'meal-select',\n                },\n                choices=[(meal.id, f'{meal.name} - {meal.price} RUB') for meal in tour.meal_options.all()]\n            )\n</code></pre> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0443\u0440\u0430. \u041e\u043d\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043b\u044e\u0434\u0435\u0439 (num_people), \u0442\u0430\u0440\u0438\u0444 (tariff) \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u0438\u0442\u0430\u043d\u0438\u044f (meal_option). \u0412 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440\u0435 \u0444\u043e\u0440\u043c\u044b \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430.</p>"},{"location":"forms/#reviewform","title":"ReviewForm","text":"<pre><code>class ReviewForm(forms.ModelForm):\n    class Meta:\n        model = Review\n        fields = ['text', 'rating']\n</code></pre> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0442\u0437\u044b\u0432\u0430. \u041e\u043d\u0430 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0434\u0432\u0430 \u043f\u043e\u043b\u044f: \u0442\u0435\u043a\u0441\u0442 \u043e\u0442\u0437\u044b\u0432\u0430 \u0438 \u0440\u0435\u0439\u0442\u0438\u043d\u0433. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043e\u0442\u0437\u044b\u0432\u0430 \u043e \u0442\u0443\u0440\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u0442\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445.</p>"},{"location":"forms/#toursearchform","title":"TourSearchForm","text":"<pre><code>class TourSearchForm(forms.Form):\n    query = forms.CharField(label='Search', max_length=100, required=False)\n</code></pre> <p>\u041f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0430 \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u0442\u0443\u0440\u043e\u0432. \u041e\u043d\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0434\u043d\u043e \u043f\u043e\u043b\u0435 query, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u043c\u043e\u0433\u0443\u0442 \u0432\u0432\u043e\u0434\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430. \u041f\u043e\u043b\u0435 \u0438\u043c\u0435\u0435\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0443\u044e \u0434\u043b\u0438\u043d\u0443 100 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f (required=False).</p>"},{"location":"models/","title":"\u041c\u043e\u0434\u0435\u043b\u0438","text":""},{"location":"models/#_2","title":"\u0422\u0443\u0440\u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440","text":"<pre><code>class TravelAgency(models.Model):\n    name = models.CharField(max_length=100)\n    contact_info = models.TextField()\n\n    def __str__(self):\n        return self.name\n</code></pre> <p>\u0425\u0440\u0430\u043d\u0438\u0442 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u0440\u043c\u044b \u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u044b.</p>"},{"location":"models/#_3","title":"\u0422\u0443\u0440","text":"<pre><code>class Tour(models.Model):\n    hotel = models.CharField(max_length=200)\n    stars = models.PositiveSmallIntegerField(\n        default=3,\n        validators=[MinValueValidator(1), MaxValueValidator(5)],\n        help_text=\"Number of stars from 1 to 5\"\n    )\n    agency = models.ForeignKey(TravelAgency, on_delete=models.CASCADE, related_name=\"tours\")\n    country = models.CharField(max_length=200)\n    city = models.CharField(max_length=200, null=True)\n    description = models.TextField()\n    start_date = models.DateField()\n    end_date = models.DateField()\n    payment_conditions = models.TextField()\n\n    def __str__(self):\n        return f\"{self.hotel} ({self.stars} stars) - {self.agency.name}\"\n\n    def get_absolute_url(self):\n        return reverse('tour_detail', args=[str(self.id)])\n\n    def get_base_price(self):\n        # \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0442\u0430\u0440\u0438\u0444\u0430 \u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f\n        tariffs = self.tariffs.all()\n        meal_options = self.meal_options.all()\n\n        if tariffs.exists() and meal_options.exists():\n            min_tariff_price = min(tariffs, key=lambda tariff: tariff.price).price\n            min_meal_option_price = min(meal_options, key=lambda meal: meal.price).price\n            return min_tariff_price + min_meal_option_price\n        return 0\n</code></pre> <p>\u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0442\u0443\u0440\u0435 (\u043e\u0442\u0435\u043b\u044c, \u0435\u0433\u043e \u0437\u0432\u0435\u0437\u0434\u043d\u043e\u0441\u0442\u044c, \u0442\u0443\u0440\u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440, \u0441\u0442\u0440\u0430\u043d\u0430, \u0433\u043e\u0440\u043e\u0434, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435, \u0434\u0430\u0442\u044b, \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u043e\u043f\u043b\u0430\u0442\u044b). \u0418\u043c\u0435\u0435\u0442 \u043c\u0435\u0442\u043e\u0434 \u043f\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044e \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u043e\u0438\u043c\u0441\u0442\u0438 \u0442\u0443\u0440\u0430)</p>"},{"location":"models/#_4","title":"\u0422\u0430\u0440\u0438\u0444","text":"<pre><code>class Tariff(models.Model):\n    tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"tariffs\")\n    name = models.CharField(max_length=200)\n    price = models.PositiveIntegerField(default=0)\n\n    class Meta:\n        unique_together = ('tour', 'name')\n\n    def __str__(self):\n        return f\"{self.name} - {self.price} RUB\"\n</code></pre> <p>\u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0445 \u0434\u043b\u044f \u0442\u0443\u0440\u0430 \u0442\u0430\u0440\u0438\u0444\u0430\u0445 \u0438 \u0438\u0445 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u0438. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c.</p>"},{"location":"models/#_5","title":"\u041e\u043f\u0446\u0438\u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f","text":"<pre><code>class MealOption(models.Model):\n    tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"meal_options\")\n    name = models.CharField(max_length=200)\n    price = models.PositiveIntegerField(default=0)\n\n    class Meta:\n        unique_together = ('tour', 'name')\n\n    def __str__(self):\n        return f\"{self.name} - {self.price} RUB\"\n</code></pre> <p>\u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u043b\u044f \u0442\u0443\u0440\u0430 \u043e\u043f\u0446\u0438\u044f\u0445 \u043f\u0438\u0442\u0430\u043d\u0438\u044f. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c.</p>"},{"location":"models/#_6","title":"\u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<pre><code>class Booking(models.Model):\n    user = models.ForeignKey(CustomUser, on_delete=models.CASCADE, related_name=\"bookings\")\n    tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"bookings\")\n    num_people = models.PositiveIntegerField(default=1)\n    tariff = models.ForeignKey(Tariff, on_delete=models.CASCADE)\n    meal_option = models.ForeignKey(MealOption, on_delete=models.CASCADE)\n    is_confirmed = models.BooleanField(default=False)\n    total_price = models.PositiveIntegerField(default=0)\n    created = models.DateField(auto_now_add=True, null=True)\n\n    def calculate_price(self):\n        # \u0420\u0430\u0441\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u043b\u044e\u0434\u0435\u0439\n        tariff_price = self.tour.get_base_price()\n        total_price = tariff_price * self.num_people\n        return round(total_price, 3)\n\n    def save(self, *args, **kwargs):\n        self.total_price = self.calculate_price()\n        super().save(*args, **kwargs)\n\n    def __str__(self):\n        return f\"Booking by {self.user.username} for {self.tour.hotel}\"\n</code></pre> <p>\u0425\u0440\u0430\u043d\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0442\u0443\u0440\u0431 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0447\u0435\u043b\u043e\u0432\u0435\u043a, \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0442\u0430\u0440\u0438\u0444, \u0432\u044b\u0431\u0440\u0430\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u0438\u0442\u0430\u043d\u0438\u044f, \u0438\u0442\u043e\u0433\u043e\u0432\u0430\u044f \u0446\u0435\u043d\u0430, \u0441\u0442\u0430\u0442\u0443\u0441 \u0438 \u0432\u0440\u0435\u043c\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0431\u0440\u043e\u043d\u0438)</p> <p>\u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0442\u0443\u0440\u043e\u043c, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c, \u0442\u0430\u0440\u0438\u0444\u043e\u043c \u0438 \u043e\u043f\u0446\u0438\u044f\u043c\u0438 \u043f\u0438\u0442\u0430\u043d\u0438\u044f. \u0418\u043c\u0435\u0435\u0442 \u043c\u0435\u0442\u043e\u0434 \u0434\u043b\u044f \u043f\u043e\u0441\u0447\u0435\u0442\u0430 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</p>"},{"location":"models/#_7","title":"\u041e\u0442\u0437\u044b\u0432","text":"<pre><code>class Review(models.Model):\n    user = models.ForeignKey(CustomUser, on_delete=models.CASCADE, related_name=\"reviews\")\n    tour = models.ForeignKey(Tour, on_delete=models.CASCADE, related_name=\"reviews\")\n    date = models.DateField(auto_now_add=True)\n    text = models.TextField()\n    rating = models.PositiveIntegerField(default=1)\n\n    def __str__(self):\n        return f\"Review by {self.user.username} ({self.rating}/10)\"\n</code></pre> <p>\u0425\u0440\u0430\u043d\u0438\u0442 \u043e\u0442\u0437\u044b\u0432\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u0421\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c \u0438 \u0442\u0443\u0440\u043e\u043c.</p>"},{"location":"overview/","title":"\u041b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 \u21162","text":""},{"location":"overview/#_1","title":"\u0422\u0435\u043c\u0430","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430 \u043d\u0430 django</p>"},{"location":"overview/#_2","title":"\u0426\u0435\u043b\u044c \u0440\u0430\u0431\u043e\u0442\u044b","text":"<p>\u041e\u0432\u043b\u0430\u0434\u0435\u0442\u044c \u043f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u043c\u0438 \u043d\u0430\u0432\u044b\u043a\u0430\u043c\u0438 \u0438 \u0443\u043c\u0435\u043d\u0438\u044f\u043c\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 web-\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438 Django 3 \u0438 PostgreSQL.</p>"},{"location":"overview/#_3","title":"\u0417\u0430\u0434\u0430\u0447\u0430","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0430\u0439\u0442 \u0442\u0443\u0440\u0444\u0438\u0440\u043c\u044b \u0441\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u043e\u043c: - \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. - \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u043e\u0432. \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0438\u043c\u0435\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0441\u0432\u043e\u0438\u0445 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439. - \u041d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043a \u0442\u0443\u0440\u0430\u043c. - \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 \u0438\u043c\u0435\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438 Django-admin. - \u0412 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430, \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0449\u0430\u044f \u0432\u0441\u0435 \u043f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0443\u0440\u044b \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c.</p>"},{"location":"overview/#_4","title":"\u0417\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u043e\u0435\u043a\u0442\u0430","text":"<pre><code>python manage.py runserver\n</code></pre>"},{"location":"urls/","title":"\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u044b","text":"<pre><code>urlpatterns = [\n    # \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f\n    path('register/', views.register, name='register'),\n    path('', login_view, name='login'),\n    path('logout/', logout_view, name='logout'),\n\n    # \u0422\u0443\u0440\u044b\n    path('tours/', views.tour_list, name='tour_list'),\n    path('tours/&lt;int:pk&gt;/', views.tour_detail, name='tour_detail'),\n    path('tours/&lt;int:tour_id&gt;/book/', views.book_tour, name='book_tour'),\n    path('tours/&lt;int:pk&gt;/add_review/', views.add_review, name='add_review'),\n\n    # \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\n    path('my_bookings/', views.my_bookings, name='my_bookings'),\n    path('my_bookings/&lt;int:pk&gt;/edit', BookingUpdateView.as_view(), name='edit_booking'),\n    path('my_bookings/&lt;int:pk&gt;/delete', BookingDeleteView.as_view(), name='delete_booking'),\n    path('bookings/&lt;int:pk&gt;/', BookingDetailView.as_view(), name='booking_detail'),\n\n    # \u0410\u0434\u043c\u0438\u043d\n    path('add_tour/', views.add_tour, name='add_tour'),\n    path('edit_tour/&lt;int:pk&gt;/', views.edit_tour, name='edit_tour'),\n    path('view_bookings/', views.view_bookings, name='view_bookings'),\n    path('confirm_booking/&lt;int:pk&gt;/', views.confirm_booking, name='confirm_booking'),\n    path('tour_sales_statistics/', views.sold_tours_by_country, name='tour_sales_statistics'),\n]\n</code></pre> <p>\u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f: - register/: \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. - login/: \u0412\u0445\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. - logout/: \u0412\u044b\u0445\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. -  \u0422\u0443\u0440\u044b: - tours/: \u0421\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0442\u0443\u0440\u043e\u0432. - tours//: \u0414\u0435\u0442\u0430\u043b\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - tours//book/: \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - tours//add_review/: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u0437\u044b\u0432\u0430 \u043a \u0442\u0443\u0440\u0443. -  \u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: - my_bookings/: \u041c\u043e\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - my_bookings//edit: \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - my_bookings//delete: \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - bookings//: \u0414\u0435\u0442\u0430\u043b\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. -  \u0410\u0434\u043c\u0438\u043d: - add_tour/: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u0442\u0443\u0440\u0430. - edit_tour//: \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0442\u0443\u0440\u0430. - view_bookings/: \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0432\u0441\u0435\u0445 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439. - confirm_booking//: \u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. - tour_sales_statistics/: \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u043f\u0440\u043e\u0434\u0430\u0436\u0430\u043c \u0442\u0443\u0440\u043e\u0432 \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c."},{"location":"views/","title":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f","text":""},{"location":"views/#_2","title":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f","text":"<pre><code>class TravelAgency(models.Model):\n    name = models.CharField(max_length=100)\n    contact_info = models.TextField()\n\n    def __str__(self):\n        return self.name\n</code></pre> <p>\u041e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0432\u0445\u043e\u0434\u0430.</p>"},{"location":"views/#_3","title":"\u0412\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443","text":"<pre><code>def login_view(request):\n    if request.method == 'POST':\n        form = AuthenticationForm(data=request.POST)\n        if form.is_valid():\n            user = form.get_user()\n            login(request, user)\n            return redirect('tour_list')\n    else:\n        form = AuthenticationForm()\n    return render(request, 'login.html', {'form': form})\n</code></pre> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0443 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043e\u0442\u0435\u043b\u0435\u0439.</p>"},{"location":"views/#_4","title":"\u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b","text":"<pre><code>@login_required\ndef logout_view(request):\n    logout(request)\n    return redirect('login')\n</code></pre> <p>\u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0432\u0445\u043e\u0434\u0430. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439.</p>"},{"location":"views/#_5","title":"\u0421\u043f\u0438\u0441\u043e\u043a \u0442\u0443\u0440\u043e\u0432","text":"<pre><code>def tour_list(request):\n    form = TourSearchForm(request.GET)\n    tours = Tour.objects.all()\n\n    if form.is_valid():\n        query = form.cleaned_data['query']\n        if query:\n            # \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c Q \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u043f\u043e\u043b\u044f\u043c\n            tours = tours.filter(\n                Q(hotel__icontains=query) |\n                Q(country__icontains=query) |\n                Q(city__icontains=query) |\n                Q(description__icontains=query)\n            )\n\n    paginator = Paginator(tours, 5)\n    page_number = request.GET.get('page')\n    page_obj = paginator.get_page(page_number)\n\n    return render(request, 'tour_list.html', {'page_obj': page_obj, 'form': form})\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0432\u0441\u0435 \u0438\u043c\u0435\u044e\u0449\u0438\u0435\u0441\u044f \u0442\u0443\u0440\u044b. \u0422\u0430\u043a \u0436\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0432\u0435\u0440\u0448\u0430\u0442\u044c \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0442\u0443\u0440\u0430\u043c (\u043f\u043e \u043f\u043e\u043b\u044f\u043c \u043e\u0442\u0435\u043b\u044c, \u0441\u0442\u0440\u0430\u043d\u0430, \u0433\u043e\u0440\u043e\u0434 \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435). \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u044e \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435.</p>"},{"location":"views/#_6","title":"\u0414\u0435\u0442\u0430\u043b\u0438 \u0442\u0443\u0440\u0430","text":"<pre><code>def tour_detail(request, pk):\n    tour = get_object_or_404(Tour, pk=pk)\n    nights = (tour.end_date - tour.start_date).days\n    return render(request, 'tour_detail.html', {'tour': tour, 'nights': nights})\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0435\u0442\u0430\u043b\u0438 \u0442\u0443\u0440\u0430 \u0438\u0437 \u043c\u043e\u0434\u0435\u043b\u0438, \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u0434\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0442\u0443\u0440\u0430.</p>"},{"location":"views/#_7","title":"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430","text":"<pre><code>@login_required\ndef book_tour(request, tour_id):\n    tour = get_object_or_404(Tour, id=tour_id)\n    if request.method == 'POST':\n        form = BookingForm(request.POST, tour=tour)\n        print(form.is_valid())\n        if form.is_valid():\n            booking = form.save(commit=False)\n            booking.tour = tour\n            booking.user = request.user\n            booking.save()\n            print(booking)\n            return redirect('my_bookings')\n    else:\n        form = BookingForm(tour=tour)\n    return render(request, 'book_tour.html', {'form': form, 'tour': tour})\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b, \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u044c \u043d\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0439 \u0442\u0443\u0440 \u0438 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0435\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439.</p>"},{"location":"views/#_8","title":"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f","text":"<pre><code>class BookingUpdateView(UpdateView):\n    model = Booking\n    form_class = BookingForm\n    template_name = 'update_booking.html'\n    success_url = reverse_lazy('my_bookings')\n\n    def get_form_kwargs(self):\n        kwargs = super().get_form_kwargs()\n        kwargs['tour'] = self.object.tour\n        return kwargs\n\n    def get_context_data(self, **kwargs):\n        context = super().get_context_data(**kwargs)\n        context['title'] = 'Edit Booking'\n        context['total_price'] = self.object.total_price\n        return context\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0431\u0440\u043e\u043d\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u041f\u0440\u0438 \u0443\u0441\u043f\u0435\u0445\u0435 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0435\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</p>"},{"location":"views/#_9","title":"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f","text":"<pre><code>class BookingDeleteView(DeleteView):\n    model = Booking\n    template_name = 'delete_booking.html'\n    success_url = reverse_lazy('my_bookings')\n    title = 'Booking Cancellation'\n</code></pre> <p>\u0423\u0434\u0430\u043b\u044f\u0435\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435. \u041f\u0440\u0438 \u0443\u0441\u043f\u0435\u0445\u0435 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439.</p>"},{"location":"views/#_10","title":"\u0414\u0435\u0442\u0430\u043b\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f","text":"<pre><code>class BookingDetailView(DetailView):\n    model = Booking\n    template_name = 'booking_detail.html'\n    context_object_name = 'booking'\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0431\u0440\u043e\u043d\u0438.</p>"},{"location":"views/#_11","title":"\u041c\u043e\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f","text":"<pre><code>@login_required\ndef my_bookings(request):\n    bookings = request.user.bookings.all()\n    return render(request, 'my_bookings.html', {'bookings': bookings})\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0432\u0441\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.</p>"},{"location":"views/#_12","title":"\u041e\u0442\u0437\u044b\u0432\u044b","text":"<pre><code>@login_required\ndef add_review(request, pk):\n    tour = get_object_or_404(Tour, pk=pk)\n    if not request.user.bookings.filter(tour=tour, is_confirmed=True).exists():\n        return redirect('my_bookings', pk=pk)\n    if request.method == 'POST':\n        form = ReviewForm(request.POST)\n        if form.is_valid():\n            review = form.save(commit=False)\n            review.user = request.user\n            review.tour = tour\n            review.save()\n            return redirect('tour_detail', pk=pk)\n    else:\n        form = ReviewForm()\n    return render(request, 'add_review.html', {'form': form, 'tour': tour})\n</code></pre> <p>\u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u043e\u0442\u0437\u044b\u0432 \u043d\u0430 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u0443\u044e \u0431\u0440\u043e\u043d\u044c. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.</p>"},{"location":"views/#_13","title":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0443\u0440\u0430","text":"<pre><code>@admin_required\ndef add_tour(request):\n    if request.method == 'POST':\n        form = TourForm(request.POST)\n\n        if form.is_valid():\n            # \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 \u043f\u0435\u0440\u0435\u0434 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432\n            tour = form.save(commit=False)\n            tour.save()\n\n            # \u041f\u0440\u0438\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d\u043d\u044b\u0439 \u0442\u0443\u0440 \u043a \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u0430\u043c\n            tariff_formset = TariffFormSet(request.POST, instance=tour)\n            meal_option_formset = MealOptionFormSet(request.POST, instance=tour)\n\n            if tariff_formset.is_valid() and meal_option_formset.is_valid():\n                tariff_formset.save()\n                meal_option_formset.save()\n                return redirect('tour_list')\n        else:\n            # \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0443\u0441\u0442\u044b\u0445 \u0444\u043e\u0440\u043c\u0441\u0435\u0442\u043e\u0432 \u043f\u0440\u0438 \u043e\u0448\u0438\u0431\u043a\u0435 \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0444\u043e\u0440\u043c\u0435\n            tariff_formset = TariffFormSet(instance=form.instance)\n            meal_option_formset = MealOptionFormSet(instance=form.instance)\n    else:\n        # \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0443\u0441\u0442\u044b\u0445 \u0444\u043e\u0440\u043c\n        form = TourForm()\n        tariff_formset = TariffFormSet(instance=Tour())\n        meal_option_formset = MealOptionFormSet(instance=Tour())\n\n    return render(request, 'add_tour.html', {\n        'form': form,\n        'tariff_formset': tariff_formset,\n        'meal_option_formset': meal_option_formset,\n    })\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b, \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0443\u0440 \u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0443\u0440\u0430. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.</p>"},{"location":"views/#_14","title":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430","text":"<pre><code>@admin_required\ndef edit_tour(request, pk):\n    tour = get_object_or_404(Tour, pk=pk)\n\n    if request.method == 'POST':\n        form = TourForm(request.POST, instance=tour)\n        tariff_formset = TariffFormSet(request.POST, instance=tour)\n        meal_option_formset = MealOptionFormSet(request.POST, instance=tour)\n\n        if form.is_valid() and tariff_formset.is_valid() and meal_option_formset.is_valid():\n            # \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0442\u0443\u0440\u0435\n            form.save()\n\n            for tariff in tariff_formset.save(commit=False):\n                tariff.tour = tour\n                tariff.save()\n\n            # \u0423\u0434\u0430\u043b\u044f\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u0430\u0440\u0438\u0444\u044b\n            for tariff in tariff_formset.deleted_objects:\n                tariff.delete()\n\n            for meal_option in meal_option_formset.save(commit=False):\n                meal_option.tour = tour\n                meal_option.save()\n\n            # \u0423\u0434\u0430\u043b\u044f\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043f\u0438\u0442\u0430\u043d\u0438\u044f\n            for meal_option in meal_option_formset.deleted_objects:\n                meal_option.delete()\n\n            return redirect('tour_list')\n\n    else:\n        form = TourForm(instance=tour)\n        tariff_formset = TariffFormSet(instance=tour)\n        meal_option_formset = MealOptionFormSet(instance=tour)\n\n    return render(request, 'edit_tour.html', {\n        'form': form,\n        'tariff_formset': tariff_formset,\n        'meal_option_formset': meal_option_formset,\n    })\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0444\u043e\u0440\u043c\u044b \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0442\u0443\u0440\u0435, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0442\u0430\u0440\u0438\u0444\u044b \u0438 \u043e\u043f\u0446\u0438\u0438 \u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u043e\u0435. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.</p>"},{"location":"views/#_15","title":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u043e\u043c","text":"<pre><code>@admin_required\ndef view_bookings(request):\n    bookings = Booking.objects.all()\n    return render(request, 'view_bookings.html', {'bookings': bookings})\n</code></pre> <p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.</p>"},{"location":"views/#_16","title":"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439","text":"<pre><code>@admin_required\ndef confirm_booking(request, pk):\n    booking = get_object_or_404(Booking, pk=pk)\n    booking.is_confirmed = True\n    booking.save()\n    return redirect('view_bookings')\n</code></pre> <p>\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u0439. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.</p>"},{"location":"views/#_17","title":"\u041f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0443\u0440\u044b \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c","text":"<pre><code>@admin_required\ndef sold_tours_by_country(request):\n    tours_by_country = (\n        Tour.objects.filter(bookings__is_confirmed=True)\n        .values('country')\n        .annotate(total_bookings=Count('bookings'))\n        .order_by('-total_bookings')\n    )\n    return render(request, 'sold_tours.html', {'tours_by_country': tours_by_country})\n</code></pre> <p>\u0424\u0438\u043b\u044c\u0442\u0440\u0443\u0435\u0442 \u0442\u0443\u0440\u044b \u0438 \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c \u0438 \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u0445 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u044b. \u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.</p>"}]}